<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Equity Options Calculator</title>
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body>
    <div id="root"></div>
    <script type="text/babel">
        const { useState, useEffect } = React;

        // Simple icon components
        const Calculator = ({ className }) => <span className={className}>üßÆ</span>;
        const DollarSign = ({ className }) => <span className={className}>üí∞</span>;
        const TrendingUp = ({ className }) => <span className={className}>üìà</span>;
        const Info = ({ className }) => <span className={className}>‚ÑπÔ∏è</span>;

        const EquityOptionsCalculator = () => {
          const [inputs, setInputs] = useState({
            optionValue: 75000,
            valuation: 250000000,
            sharePrice: 9.038,
            strikePrice: 2.51,
            futureValuation: 500000000
          });

          const [results, setResults] = useState({
            numberOfShares: 0,
            exerciseCost: 0,
            exercisePercentage: 0,
            potentialGain: 0,
            roi: 0,
            futureSharePrice: 0,
            futureValue: 0,
            futureGain: 0,
            futureRoi: 0,
            ownershipPercentage: 0
          });

          // Load URL parameters on mount
          useEffect(() => {
            const urlParams = new URLSearchParams(window.location.search);
            const newInputs = { ...inputs };
            
            if (urlParams.get('optionValue')) newInputs.optionValue = parseFloat(urlParams.get('optionValue'));
            if (urlParams.get('valuation')) newInputs.valuation = parseFloat(urlParams.get('valuation'));
            if (urlParams.get('sharePrice')) newInputs.sharePrice = parseFloat(urlParams.get('sharePrice'));
            if (urlParams.get('strikePrice')) newInputs.strikePrice = parseFloat(urlParams.get('strikePrice'));
            if (urlParams.get('futureValuation')) newInputs.futureValuation = parseFloat(urlParams.get('futureValuation'));
            
            setInputs(newInputs);
          }, []);

          useEffect(() => {
            calculateResults();
            updateURL();
          }, [inputs]);

          const calculateResults = () => {
            const { optionValue, sharePrice, strikePrice, valuation, futureValuation } = inputs;
            
            // Handle empty values - convert to numbers, defaulting to 0
            const optVal = parseFloat(optionValue) || 0;
            const shareP = parseFloat(sharePrice) || 0;
            const strikeP = parseFloat(strikePrice) || 0;
            const val = parseFloat(valuation) || 0;
            const futureVal = parseFloat(futureValuation) || 0;
            
            if (shareP <= 0 || strikeP < 0 || optVal <= 0 || val <= 0) {
              // Reset results if invalid inputs
              setResults({
                numberOfShares: 0,
                exerciseCost: 0,
                exercisePercentage: 0,
                potentialGain: 0,
                roi: 0,
                futureSharePrice: 0,
                futureValue: 0,
                futureGain: 0,
                futureRoi: 0,
                ownershipPercentage: 0
              });
              return;
            }
            
            const numberOfShares = optVal / shareP;
            const exerciseCost = numberOfShares * strikeP;
            const exercisePercentage = (exerciseCost / optVal) * 100;
            const potentialGain = (numberOfShares * shareP) - exerciseCost;
            const roi = exerciseCost > 0 ? ((potentialGain / exerciseCost) * 100) : 0;

            // Calculate ownership percentage
            const totalShares = val / shareP; // Total company shares outstanding
            const ownershipPercentage = (numberOfShares / totalShares) * 100;

            // Future value calculations - only if we have both current and future valuations
            let futureSharePrice = 0;
            let futureValue = 0;
            let futureGain = 0;
            let futureRoi = 0;

            if (futureVal > 0 && val > 0) {
              // Calculate future share price based on valuation growth
              futureSharePrice = shareP * (futureVal / val);
              futureValue = numberOfShares * futureSharePrice;
              futureGain = futureValue - exerciseCost;
              futureRoi = exerciseCost > 0 ? ((futureGain / exerciseCost) * 100) : 0;
            }

            setResults({
              numberOfShares: Math.round(numberOfShares),
              exerciseCost: Math.round(exerciseCost),
              exercisePercentage: exercisePercentage,
              potentialGain: Math.round(potentialGain),
              roi: roi,
              futureSharePrice: futureSharePrice,
              futureValue: Math.round(futureValue),
              futureGain: Math.round(futureGain),
              futureRoi: futureRoi,
              ownershipPercentage: ownershipPercentage
            });
          };

          const updateURL = () => {
            const params = new URLSearchParams();
            if (inputs.optionValue) params.set('optionValue', inputs.optionValue);
            if (inputs.valuation) params.set('valuation', inputs.valuation);
            if (inputs.sharePrice) params.set('sharePrice', inputs.sharePrice);
            if (inputs.strikePrice) params.set('strikePrice', inputs.strikePrice);
            if (inputs.futureValuation) params.set('futureValuation', inputs.futureValuation);
            
            const newURL = window.location.pathname + '?' + params.toString();
            window.history.replaceState({}, '', newURL);
          };

          const handleInputChange = (field, value) => {
            // Always update with the actual value (including empty string)
            setInputs(prev => ({
              ...prev,
              [field]: value
            }));
          };

          const setPresetFutureValuation = (value) => {
            setInputs(prev => ({
              ...prev,
              futureValuation: value
            }));
          };

          const formatValuation = (amount) => {
            if (amount >= 1000000000) {
              return `${(amount / 1000000000).toFixed(1)}B`;
            } else if (amount >= 1000000) {
              return `${(amount / 1000000).toFixed(0)}M`;
            }
            return formatCurrency(amount);
          };

          const formatCurrency = (amount) => {
            return new Intl.NumberFormat('en-US', {
              style: 'currency',
              currency: 'USD',
              minimumFractionDigits: 0,
              maximumFractionDigits: 0
            }).format(amount);
          };

          const formatNumber = (num) => {
            return new Intl.NumberFormat('en-US').format(num);
          };

          return (
            <div className="min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 p-4">
              <div className="max-w-4xl mx-auto">
                <div className="bg-white rounded-xl shadow-xl p-8">
                  {/* Header */}
                  <div className="text-center mb-8">
                    <div className="flex items-center justify-center mb-4">
                      <Calculator className="w-8 h-8 text-indigo-600 mr-3" />
                      <h1 className="text-3xl font-bold text-gray-900">Equity Options Calculator</h1>
                    </div>
                    <p className="text-gray-600">Calculate exercise costs and potential returns for your stock options</p>
                  </div>

                  <div className="grid md:grid-cols-2 gap-8">
                    {/* Input Section */}
                    <div className="space-y-6">
                      <h2 className="text-xl font-semibold text-gray-800 flex items-center">
                        <DollarSign className="w-5 h-5 mr-2" />
                        Option Details
                      </h2>

                      <div className="space-y-4">
                        <div>
                          <label className="block text-sm font-medium text-gray-700 mb-2">
                            Option Grant Value
                          </label>
                          <div className="relative">
                            <span className="absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-500">$</span>
                            <input
                              type="number"
                              step="1000"
                              value={inputs.optionValue}
                              onChange={(e) => handleInputChange('optionValue', e.target.value)}
                              className="w-full pl-8 pr-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500"
                              placeholder="75000"
                            />
                          </div>
                        </div>

                        <div>
                          <label className="block text-sm font-medium text-gray-700 mb-2">
                            Company Valuation
                          </label>
                          <div className="relative">
                            <span className="absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-500">$</span>
                            <input
                              type="number"
                              step="1000"
                              value={inputs.valuation}
                              onChange={(e) => handleInputChange('valuation', e.target.value)}
                              className="w-full pl-8 pr-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500"
                              placeholder="250000000"
                            />
                          </div>
                          <p className="text-xs text-gray-500 mt-1">Current company valuation (e.g., Series B)</p>
                        </div>

                        <div>
                          <label className="block text-sm font-medium text-gray-700 mb-2">
                            Preferred Share Price
                          </label>
                          <div className="relative">
                            <span className="absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-500">$</span>
                            <input
                              type="number"
                              step="0.001"
                              value={inputs.sharePrice}
                              onChange={(e) => handleInputChange('sharePrice', e.target.value)}
                              className="w-full pl-8 pr-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500"
                              placeholder="9.038"
                            />
                          </div>
                          <p className="text-xs text-gray-500 mt-1">Current fair market value per share</p>
                        </div>

                        <div>
                          <label className="block text-sm font-medium text-gray-700 mb-2">
                            Strike Price (Exercise Price)
                          </label>
                          <div className="relative">
                            <span className="absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-500">$</span>
                            <input
                              type="number"
                              step="0.01"
                              value={inputs.strikePrice}
                              onChange={(e) => handleInputChange('strikePrice', e.target.value)}
                              className="w-full pl-8 pr-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500"
                              placeholder="2.51"
                            />
                          </div>
                          <p className="text-xs text-gray-500 mt-1">Price you pay to exercise options (after discounts)</p>
                        </div>

                        <div>
                          <label className="block text-sm font-medium text-gray-700 mb-2">
                            Future Company Valuation (Optional)
                          </label>
                          <div className="relative">
                            <span className="absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-500">$</span>
                            <input
                              type="number"
                              step="1000"
                              value={inputs.futureValuation}
                              onChange={(e) => handleInputChange('futureValuation', e.target.value)}
                              className="w-full pl-8 pr-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-purple-500"
                              placeholder="500000000"
                            />
                          </div>
                          <p className="text-xs text-gray-500 mt-1">Projected future valuation for scenario analysis</p>
                          
                          {/* Preset buttons */}
                          <div className="mt-4 space-y-3">
                            <div className="grid grid-cols-2 gap-2">
                              <button
                                onClick={() => setPresetFutureValuation(1000000000)}
                                className="px-3 py-2 text-sm bg-purple-100 text-purple-800 rounded-lg hover:bg-purple-200 transition-colors"
                                type="button"
                              >
                                $1B
                              </button>
                              <button
                                onClick={() => setPresetFutureValuation(2500000000)}
                                className="px-3 py-2 text-sm bg-purple-100 text-purple-800 rounded-lg hover:bg-purple-200 transition-colors"
                                type="button"
                              >
                                $2.5B
                              </button>
                              <button
                                onClick={() => setPresetFutureValuation(10000000000)}
                                className="px-3 py-2 text-sm bg-purple-100 text-purple-800 rounded-lg hover:bg-purple-200 transition-colors"
                                type="button"
                              >
                                $10B
                              </button>
                              <button
                                onClick={() => setPresetFutureValuation(100000000000)}
                                className="px-3 py-2 text-sm bg-purple-100 text-purple-800 rounded-lg hover:bg-purple-200 transition-colors"
                                type="button"
                              >
                                $100B
                              </button>
                            </div>
                            <button
                              onClick={() => setPresetFutureValuation(1000000000000)}
                              className="w-full px-4 py-3 text-lg font-bold bg-gradient-to-r from-yellow-400 via-yellow-500 to-yellow-600 text-yellow-900 rounded-lg hover:from-yellow-500 hover:via-yellow-600 hover:to-yellow-700 transform hover:scale-105 transition-all duration-200 shadow-lg"
                              type="button"
                            >
                              üí∞ ONE TRILLION DOLLARS üí∞
                            </button>
                          </div>
                        </div>
                      </div>
                    </div>

                    {/* Results Section */}
                    <div className="space-y-6">
                      <h2 className="text-xl font-semibold text-gray-800 flex items-center">
                        <TrendingUp className="w-5 h-5 mr-2" />
                        Calculation Results
                      </h2>

                      <div className="space-y-4">
                        <div className="bg-gray-50 rounded-lg p-4">
                          <div className="text-sm text-gray-600 mb-1">Number of Shares</div>
                          <div className="text-2xl font-bold text-gray-900">
                            {formatNumber(results.numberOfShares)}
                          </div>
                        </div>

                        <div className="bg-indigo-50 rounded-lg p-4">
                          <div className="text-sm text-indigo-600 mb-1">Exercise Cost</div>
                          <div className="text-2xl font-bold text-indigo-900">
                            {formatCurrency(results.exerciseCost)}
                          </div>
                          <div className="text-sm text-indigo-600 mt-1">
                            {results.exercisePercentage.toFixed(1)}% of grant value
                          </div>
                        </div>

                        <div className="bg-green-50 rounded-lg p-4">
                          <div className="text-sm text-green-600 mb-1">Potential Gain (Current Value)</div>
                          <div className="text-2xl font-bold text-green-900">
                            {formatCurrency(results.potentialGain)}
                          </div>
                          <div className="text-sm text-green-600 mt-1">
                            {results.roi.toFixed(0)}% ROI if exercised today
                          </div>
                        </div>

                        <div className="bg-orange-50 rounded-lg p-4">
                            <div className="text-sm text-purple-600 mb-1">Potential Gain - Possible Future Value</div>
                            <div className="text-2xl font-bold text-purple-900">
                              {formatCurrency(results.futureGain)}
                            </div>
                            <div className="text-sm text-purple-600 mt-1">
                              {results.futureRoi.toFixed(0)}% ROI ‚Ä¢ {formatCurrency(results.futureSharePrice)}/share
                            </div>
                            <div className="text-xs text-purple-500 mt-2">
                              Total value: {formatCurrency(results.futureValue)} at {formatValuation(parseFloat(inputs.futureValuation) || 0)} valuation
                            </div>
                          </div>
                        )}
                      </div>
                    </div>
                  </div>

                  {/* Summary Section */}
                  <div className="mt-8 bg-blue-50 rounded-lg p-6">
                    <div className="flex items-start">
                      <Info className="w-5 h-5 text-blue-600 mr-3 mt-0.5" />
                      <div>
                        <h3 className="font-semibold text-blue-900 mb-2">Summary</h3>
                        <p className="text-blue-800 text-sm leading-relaxed mb-3">
                          To exercise your full option grant of <strong>{formatCurrency(inputs.optionValue || 0)}</strong>, 
                          you would need to pay <strong>{formatCurrency(results.exerciseCost)}</strong> for <strong>{formatNumber(results.numberOfShares)} shares</strong>. 
                          This represents <strong>{results.exercisePercentage.toFixed(1)}%</strong> of your grant's current value. 
                          At today's valuation, your options would be worth <strong>{formatCurrency(results.potentialGain)}</strong> more than the exercise cost.
                        </p>
                        {(inputs.futureValuation && parseFloat(inputs.futureValuation) > parseFloat(inputs.valuation || 0) && results.futureGain > 0) && (
                          <p className="text-purple-800 text-sm leading-relaxed">
                            <strong>Future Scenario:</strong> If the company reaches a <strong>{formatValuation(parseFloat(inputs.futureValuation) || 0)} valuation</strong>, 
                            your {formatNumber(results.numberOfShares)} shares would be worth <strong>{formatCurrency(results.futureValue)}</strong>, 
                            giving you a potential gain of <strong>{formatCurrency(results.futureGain)}</strong> 
                            (a <strong>{results.futureRoi.toFixed(0)}% return</strong> on your {formatCurrency(results.exerciseCost)} exercise cost).
                          </p>
                        )}
                      </div>
                    </div>
                  </div>

                  {/* Footer */}
                  <div className="mt-6 text-center text-xs text-gray-500">
                    <p>This calculator is for estimation purposes only. Consult with your financial advisor and review your option agreement for exact terms.</p>
                  </div>
                </div>
              </div>
            </div>
          );
        };

        ReactDOM.render(<EquityOptionsCalculator />, document.getElementById('root'));
    </script>
</body>
</html>
